<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>MCQ Test</title>

<script src="https://cdn.emailjs.com/dist/email.min.js"></script>
<script>
(function(){
  emailjs.init("5yWeyqCS6d88LlA3e"); // ✅ Public Key
})();
</script>

<style>
body { font-family: Arial; padding: 20px; }
.question { margin: 20px 0; }
.review-wrong { border-left: 4px solid red; padding: 8px; margin: 10px 0; }
.review-correct { border-left: 4px solid green; padding: 8px; margin: 10px 0; }
.review-skip { border-left: 4px solid orange; padding: 8px; margin: 10px 0; }
</style>
</head>

<body>

<h2>Enter Details</h2>
<input id="user_name" placeholder="Name"><br><br>
<input id="user_mobile" placeholder="Mobile"><br><br>
<button onclick="startTest()">Start Test</button>

<hr>

<div id="quiz" style="display:none;">
  <h3 id="qno"></h3>
  <p id="question"></p>
  <div id="options"></div>
  <br>
  <button onclick="nextQuestion()">Next</button>
  <button onclick="skipQuestion()">Skip</button>
  <button onclick="finalSubmit()">Final Submit</button>
</div>

<div id="result"></div>

<script>
const questions = [
  {
    q: "निम्नलिखित में से किस अधिनियम ने कलकत्ता में सर्वोच्च न्यायालय की स्थापना की?",
    options: ["रेगुलेटिंग एक्ट, 1773", "पिट्स इंडिया एक्ट, 1784"],
    answer: 1,
    explanation: "1774 में कलकत्ता में सर्वोच्च न्यायालय की स्थापना हुई।"
  }
];

let i = 0, correct = 0, wrong = 0, skipped = 0;
let answers = [];

function startTest(){
  if(!user_name.value || !user_mobile.value){
    alert("Name & Mobile required");
    return;
  }
  quiz.style.display = "block";
  loadQuestion();
}

function loadQuestion(){
  if(i >= questions.length) return;
  qno.innerText = `Question ${i+1}/${questions.length}`;
  question.innerText = questions[i].q;
  options.innerHTML = "";
  questions[i].options.forEach((o,idx)=>{
    options.innerHTML += `
      <label>
        <input type="radio" name="opt" value="${idx}">
        ${o}
      </label><br>`;
  });
}

function nextQuestion(){
  const sel = document.querySelector('input[name="opt"]:checked');
  if(sel){
    answers[i] = parseInt(sel.value);
  } else {
    answers[i] = null;
  }
  i++;
  loadQuestion();
}

function skipQuestion(){
  answers[i] = null;
  i++;
  loadQuestion();
}

function finalSubmit(){
  let reviewHTML = "";
  answers.forEach((a,idx)=>{
    const q = questions[idx];
    if(a === null){
      skipped++;
      reviewHTML += `
        <div class="review-skip">
        <b>Q:</b> ${q.q}<br>
        <b>Status:</b> Skipped<br>
        <b>Correct:</b> ${q.options[q.answer]}<br>
        <b>Explanation:</b> ${q.explanation}
        </div>`;
    }
    else if(a === q.answer){
      correct++;
      reviewHTML += `
        <div class="review-correct">
        <b>Q:</b> ${q.q}<br>
        <b>Your:</b> ${q.options[a]}<br>
        <b>Correct</b><br>
        <b>Explanation:</b> ${q.explanation}
        </div>`;
    }
    else{
      wrong++;
      reviewHTML += `
        <div class="review-wrong">
        <b>Q:</b> ${q.q}<br>
        <b>Your:</b> ${q.options[a]}<br>
        <b>Correct:</b> ${q.options[q.answer]}<br>
        <b>Explanation:</b> ${q.explanation}
        </div>`;
    }
  });

  result.innerHTML = `
    <h2>Score: ${correct}/${questions.length}</h2>
    Correct: ${correct}, Wrong: ${wrong}, Skipped: ${skipped}
    <hr>${reviewHTML}
  `;

  // ✅ EMAIL (4:55 PM WORKING STYLE)
  emailjs.send("service_fyssovx","template_qfj8k1q",{
    user_name: user_name.value,
    user_mobile: user_mobile.value,
    score: `${correct}/${questions.length}`,
    total: questions.length,
    correct: correct,
    wrong: wrong,
    unattempted: skipped,
    result_details: reviewHTML
  }).then(()=>{
    console.log("Email sent");
  }).catch(err=>{
    console.log("Email error", err);
  });
}
</script>

</body>
</html>
